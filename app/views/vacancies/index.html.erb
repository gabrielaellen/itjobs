<div class="container">
  <div class="row">
    <!-- BEGIN SEARCH RESULT -->
    <div class="col-md-12">
      <div class="grid search">
        <div class="grid-body">
          <div class="row">
            <!-- BEGIN FILTERS -->
            <div class="col-md-3">
              <%= render "partials/filters", vacancies: @vacancies %>
            </div>
            <!-- END FILTERS -->
            <!-- BEGIN RESULT -->
            <div class="col-md-9">
              <h3><i class="fa-regular fa-file"></i> Resultado</h3>
              <hr>
              <!-- BEGIN SEARCH INPUT -->
              <%= form_with url: vacancies_path, method: :get, local:true do |form| %>
                <div class="input-group">
                  <%= form.text_field :q, class: "form-control", placeholder: "Pesquisar...", value: params[:q] %>
                  <span class="input-group-btn">
                    <button class="btn btn-primary mb-0 rounded-0 rounded-end" type="submit"><i class="fa fa-search"></i></button>
                  </span>
                </div>
              <% end %>
              <!-- END SEARCH INPUT -->
              <% if params[:q].present? %>
                <p>Exibindo resultados para a pesquisa "<%= params[:q] %>"</p>
              <% end %>
              <div class="py-3"></div>
              
              <!-- BEGIN TABLE RESULT -->
              <div class="table-responsive">
                <table class="table table-striped table-hover">
                  <tbody>
                    <% @vacancies.each do |vacancy| %>
                      <tr>
                        <td class="product"><h4><a href="<%= vacancy.url %>" target="_blank"><%= vacancy.title %></a></h4>
                          <div class="">
                            <%= markdown(truncate(vacancy.body, length: 300, omission: '... ')) %>
                          </div>
                          <div>
                            <% vacancy.tags.each do |tag| %>
                              <%= link_to vacancies_path(label: tag['name']), class: "text-decoration-none" do %>
                                <span class="badge badge-pill " style="background-color:#<%= tag.to_h['color']%>"><%= tag.to_h['name']%></span>
                              <% end %>
                            <% end%>
                          </div>
                        </td>
                      </tr>
                    <% end%>
                  </tbody>
                </table>
              </div>
              <!-- END TABLE RESULT -->
              <!-- BEGIN PAGINATION -->

              <%== pagy_bootstrap_nav(@pagy) %>

              <!-- END PAGINATION -->
            </div>
            <!-- END RESULT -->
          </div>
        </div>
      </div>
    </div>
    <!-- END SEARCH RESULT -->
  </div>
</div>
